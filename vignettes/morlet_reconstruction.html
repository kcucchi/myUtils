<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Karina Cucchi" />

<meta name="date" content="2018-05-23" />

<title>Morlet wavelet analysis</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Morlet wavelet analysis</h1>
<h4 class="author"><em>Karina Cucchi</em></h4>
<h4 class="date"><em>2018-05-23</em></h4>



<p>This vignette documents the use of the Morlet wavelet decomposition/recomposition functions from <code>myUtils</code> for future reference. I wrote functions for performing wavelet analysis based on the Morlet wavelet because I found no package that allowed to easily filter out unwanted scales and reconstruct timeseries corresponding to scales of interest only.</p>
<p>The code was written based on the paper <a href="https://journals.ametsoc.org/doi/abs/10.1175/1520-0477%281998%29079%3C0061%3AAPGTWA%3E2.0.CO%3B2">Torrence and Campo, 1998</a> and its implementation proposed in a Stack Overflow <a href="http://www.r-https://stackoverflow.com/questions/22131080/wavelet-reconstruction-of-time-series">post</a>.</p>
<p>This vignette estimates time series of amplitudes and timings of periodicities of interest using wavelet decomposition and reconstruction.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(myUtils)</code></pre></div>
<div id="wavelet-decomposition" class="section level1">
<h1>Wavelet decomposition</h1>
<div id="example-periodic-function" class="section level2">
<h2>Example periodic function</h2>
<p>First, letâ€™s first define an toy periodic time series.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># example of monthly time series with biyearly, yearly and biennial periodicities</span>
y &lt;-<span class="st"> </span><span class="fl">0.3</span><span class="op">*</span><span class="kw">cos</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">6</span><span class="op">*</span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) <span class="op">+</span><span class="st"> </span><span class="co"># biyearly</span>
<span class="st">  </span><span class="fl">0.5</span><span class="op">*</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">4</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">12</span><span class="op">*</span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) <span class="op">+</span><span class="st"> </span><span class="co"># yearly</span>
<span class="st">  </span><span class="fl">0.2</span><span class="op">*</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">4</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">24</span><span class="op">*</span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) <span class="co"># biennial</span>

<span class="co"># add some noise</span>
y &lt;-<span class="st"> </span>y <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span><span class="op">*</span><span class="kw">rnorm</span>(<span class="dv">100</span>) 

<span class="co"># define corresponding time vector</span>
t &lt;-<span class="st"> </span><span class="kw">seq.Date</span>(<span class="dt">from =</span> <span class="kw">as.Date</span>(<span class="st">'2000-01-01'</span>),
              <span class="dt">by =</span> <span class="st">&quot;1 month&quot;</span>,
              <span class="dt">length.out =</span> <span class="kw">length</span>(y))

<span class="co"># visualize</span>
<span class="kw">plot</span>(<span class="dt">x =</span> t,<span class="dt">y =</span> y,<span class="dt">type=</span><span class="st">'l'</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAQlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6kNtmAABmtv+QOgCQZgCQ2/+2ZgC2///bkDrb////tmb/25D//7b//9v///9jXg8IAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHTklEQVR4nO3d6WKbMBAEYLVNrzSu6za8/6uWwya2tNKsYBGSmfmREndZ0BfAJ9h1TDJu7xWoPQQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBGIM5JrJXkC27bZLYaD8P8ze4RYEQiAhLjKtnsl4HarLgYFUi3XHBdLdNxAIFB13F3OqxRIoq6p6IMvlHhhIW/WMQLo7HuVCjwukZFSUucYeKBIIFRIIFaqOGwQqVkUgWHQYIP8mp1psCaB/P773Py/Ouc+/17bbA+i+bDug85c/w9TPle2W7BaRZdQFdKUZmVa0W7RbRJZRF9DfryPQJbKTFQAK7vpVvdz84+53TfbbgnSj0gHhXoWAhne+Xrrb4XpFu+cE6kajT2/9HVnEh0BW7eRBqY4uSiAn/Fox0KJByVVtAJ0z78UMh94GkN8FfHjBcOjhI0xVr8p3MQKBdoZDD6r8octLLAT0/jrtSLlPVncHcv7abQN0vj3+iT4QkttZDr1moPfXmSXvqYbl0GsGunuRI+/Jankgv6qyLajk0GsC6o9B100IHIOyV1esig398SZFL1cM6Pp83rnI9pMHFHp4A5CAgqN7bIl3NxUEUrazARJ76YAeqwj0bEDO+/fjt/SgwqqItbdvEigN5FoAkgaVAnIzqiXQ4x9Al02AhFHlA0VbLQAKl1gVUGRQFkDxVg0DuWAirHKqKgKpex0QKCwXeiVatQrkCBR2NQR6HHpswB7Qx4tDa4D656Ev2plguwSQ7uhSIdDwYoaLvqWc2S4FpBmU8/9DrNIxus4KqDMwenagiSj6noW6XeoY1DLQ8PHDn937a/T1MG278J8nABpeLZxkYq/I69ulgKRld4uA1FWC6JJ7sU9v2plgu9s/bv6tJFDw5zEBsokEFB1UuIs8LVDw6Y7beOeN5+BAQbt6gFwnutQK5MTqjkBKIKksufMIVa5NIG8TCRYeDEpcw4VAQllFQJrVXVQVoXsE8sbXLJA/X2QVVUDuqEB+L2lPbA5IeUSwA3ItAU1H6MJA3htGBwIK3yCNALVzkDYHwlWHBvJf1jkOkGrbUAL56LUCXXFUQHcjj1fdbRlPCiSt77ZA8zrE1k+VKoDSf/YZKJwvfVtxoJwLC8xAwS1BdQAkVUlmcq+Hm/zhFQBSXljgsEDa08LzgB5vEqqUZhUAaS8sMI/qaEC5WxAGCsfZMJD+wgKHBOoyLiwgAomr+1xA6nbFgYTbGgPq5BMznxQIX1jAKYCEseuBpLEHvcQldkFlIlttQeL2ogPCIz8yUGRHbB1IuDSFHZDOrA6gjAsLHBIo58ICmwJpj2fh6DYFyrqwgAAkrm5YZQYUWaK3oiA5QFkXFlgKJDZtBGjlFiRv8AuB5KHvDKS+sMA0VRhIaFYcSHthgWlqUyB52bsDZbRLrNzDLRogTSsRSCyKNpAXri38yN2hKNVuU6DIshsHkspVVQQCVQRCVbpourUGpPziK11UQHfnjyibmiaznXrfUdbpF98IkHEyvsWUQKjUvHCXdtst/qBA+hAIhEAgBALZDaiZ7ASU07TWqvXzGDWttWr9PEZNa61aP49R01qr1s9j1LTWqvXzGDWttWr9PEZNa61aP49R01qr1s9j1LTWqvXzHCoEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEYgE0nsExfmbo4tx0RdhwwqBXn1POhYpTvYbLQkfO/X+MAdD7a7/M83Cy72U4n3VYgXDCoFc3jC8DKNXrPJ55qxEyAJpOpT9//j199Oz00oUTBr268WPaGUDJ9XrRrpfZMaj/w8xrFE4Y9Bp+fvmVfS1wsdceQKd++d+GHeEiTRj06jeJb29Zx6BEr6K72Jjh7I3pSNH/DCcMeo07SDZQpJf+zsMI6HI7FhoARXqNZxjlAsV69dtVf4zSfAGEDdB09o/NLpbslQkU7aU/NpoAXU/VNDlIR3udr59bUT16Ab0ytmwLoNtpZAZ384leY7K2oHivSUq1ZZs8Drrty+sfKKZ6DckBSvUqegy6bvvjA9S7R/LehEGvLg8o2evklF/SwyerIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRBIA0CXjA+82Kd+oOh3mZUJgUCqB/r7NXH56gKpHohbEAqBQAgEQiAQAoEQCCT6hZNlUj9Qd+LjoJpDIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFA/gNGaa6z8KNRnwAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="wavelet-transform" class="section level2">
<h2>Wavelet transform</h2>
<p>The wavelet transform (Equation 2 in <a href="https://journals.ametsoc.org/doi/abs/10.1175/1520-0477%281998%29079%3C0061%3AAPGTWA%3E2.0.CO%3B2">Torrence and Campo, 1998</a>) is defined in the function <code>myUtils::wt</code>. It outputs a matrix, where the rows correspond to time points and the columns correspond to periodicities. If the vector of time points <code>vect_time</code> and the time resolution <code>dt</code> are provided as arguments to the function, corresponding values of time and periodicities are assigned to column and row names in the output matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mat_wt &lt;-<span class="st"> </span><span class="kw">wt</span>(<span class="dt">y =</span> y,<span class="dt">vect_time =</span> t,<span class="dt">dt=</span><span class="dv">1</span><span class="op">/</span><span class="dv">12</span>)
<span class="kw">str</span>(mat_wt)
<span class="co">#&gt;  cplx [1:100, 1:111] 0.191-0.005i -0.159+0.026i 0.103-0.031i ...</span>
<span class="co">#&gt;  - attr(*, &quot;dimnames&quot;)=List of 2</span>
<span class="co">#&gt;   ..$ : chr [1:100] &quot;2000-01-01&quot; &quot;2000-02-01&quot; &quot;2000-03-01&quot; &quot;2000-04-01&quot; ...</span>
<span class="co">#&gt;   ..$ : chr [1:111] &quot;0.166666666666667&quot; &quot;0.181751288777543&quot; &quot;0.198201185833787&quot; &quot;0.216139925775168&quot; ...</span></code></pre></div>
<p>In the output, each element corresponds to the wavelet coefficient for the time point <code>vect_time[i]</code>, and the scale s defined as <code>dt*2*2^(j*.125)</code>.</p>
<p>When <code>vect_time</code> and <code>dt</code> are provided as arguments to the function <code>wt</code>, <code>plot_re</code> makes it easy to visualize the real part of the wavelet decomposition as a function of time and scale.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">print</span>(<span class="kw">plot_re</span>(mat_wt) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept=</span><span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.6</span>,
                                    <span class="fl">0.8</span>,<span class="fl">1.2</span>,
                                    <span class="fl">1.7</span>,<span class="fl">2.3</span>))) <span class="op">+</span>
<span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans=</span><span class="st">'log10'</span>,
                           <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>),
                           <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2</span><span class="op">/</span><span class="dv">12</span>,<span class="dv">3</span>)))
<span class="co">#&gt; Scale for 'y' is already present. Adding another scale for 'y', which</span>
<span class="co">#&gt; will replace the existing scale.</span>
<span class="co">#&gt; Warning: Removed 7700 rows containing missing values (geom_tile).</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Positive values (in red) indicate that the time series and the Morlet wavelet are in phase at the time and scale of interest, negative values (in blue) rather indicate that they are in phase opposition.</p>
<p>Here, the wavelet decomposition correctly identifies the 3 main periodicities in the time series, as well as the corresponding strengths.</p>
</div>
<div id="visualize-power-spectrum" class="section level2">
<h2>Visualize power spectrum</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_pow &lt;-<span class="st"> </span><span class="kw">mat_2_df</span>(<span class="kw">calc_power</span>(mat_wt))
<span class="kw">head</span>(df_pow)
<span class="co">#&gt;         date    period        value</span>
<span class="co">#&gt; 1 2000-01-01 0.1666667 0.0181891671</span>
<span class="co">#&gt; 2 2000-02-01 0.1666667 0.0129329426</span>
<span class="co">#&gt; 3 2000-03-01 0.1666667 0.0057620504</span>
<span class="co">#&gt; 4 2000-04-01 0.1666667 0.0015890963</span>
<span class="co">#&gt; 5 2000-05-01 0.1666667 0.0003348602</span>
<span class="co">#&gt; 6 2000-06-01 0.1666667 0.0008673894</span>

<span class="kw">print</span>(<span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_tile</span>(<span class="dt">data =</span> df_pow,
                  <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>date,<span class="dt">y=</span>period,<span class="dt">fill=</span>value)) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept=</span><span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.6</span>,
                                    <span class="fl">0.8</span>,<span class="fl">1.2</span>,
                                    <span class="fl">1.7</span>,<span class="fl">2.3</span>))) <span class="op">+</span>
<span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans=</span><span class="st">'log10'</span>,
                           <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>),
                           <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.2</span>,<span class="dv">4</span>)) <span class="op">+</span>
<span class="st">        </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;Spectral&quot;</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">        </span><span class="kw">ggtitle</span>(<span class="st">'power spectrum'</span>))
<span class="co">#&gt; Warning: Removed 7700 rows containing missing values (geom_tile).</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="time-series-reconstruction" class="section level1">
<h1>Time series reconstruction</h1>
<div id="reconstructing-the-original-time-series" class="section level2">
<h2>Reconstructing the original time series</h2>
<p>Before filtering out specific periodicities from the original time series, we first want to make sure that the time series reconstructed using all frequencies is equal to the original time series, so that the deconstruction reconstruction combine to the identity function.</p>
<p>The inverse wavelet transform is defined in the function <code>wt_inverse</code>. <code>wt_inverse</code> provides the option to specify the mean of the original time series <code>y.m</code>: this mean value will be added to the output of the centered wavelet reconstruction.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rec_wt &lt;-<span class="st"> </span><span class="kw">wt_inverse</span>(<span class="dt">mat_wt =</span> mat_wt,<span class="dt">y.m =</span> <span class="kw">mean</span>(y))
<span class="kw">plot</span>(<span class="dt">x =</span> t,<span class="dt">y =</span> rec_wt,<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">ylab=</span><span class="st">'y'</span>)
<span class="kw">lines</span>(<span class="dt">x =</span> t,<span class="dt">y =</span> y,<span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">legend</span>(<span class="st">'topright'</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;original&quot;</span>, <span class="st">&quot;reconstructed&quot;</span>),
       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The original time series (in black) and the reconstructed time series (in red) align perfectly.</p>
</div>
<div id="reconstruct-1-year-periodicity" class="section level2">
<h2>Reconstruct 1 year periodicity</h2>
<p>For example, letâ€™s consider that we are interested in the studying the time series with a 1-year periodicity.</p>
<p>The function <code>wt_extract</code> extracts wavelet coefficients within range of scales provided by <code>range_scale</code>. The output is a matrix with the same dimension as provided in the argument <code>mat_wt</code>, but where wavelet coefficients outside of the provided scale range are set to 0.</p>
<p>Here, we extract coefficients in the period range from 0.8 to 1.2 years, which contains the 1-year periodicity signal according to the Figure showing wavelet coefficients.</p>
<p>The one-year periodicity reconstruction is obtained by applying the inverse wavelet transform function to the matrix containing selected coefficients.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mat_wt_1y &lt;-
<span class="st">  </span><span class="kw">wt_extract</span>(<span class="dt">mat_wt =</span> mat_wt,
             <span class="dt">range_scale =</span> <span class="kw">c</span>(<span class="fl">0.8</span>,<span class="fl">1.2</span>))
rec_wt_1y &lt;-
<span class="st">  </span><span class="kw">wt_inverse</span>(<span class="dt">mat_wt =</span> mat_wt_1y,<span class="dt">y.m =</span> <span class="kw">mean</span>(y))

<span class="co"># plot reconstructed time series</span>
<span class="kw">plot</span>(<span class="dt">x =</span> t,<span class="dt">y =</span> rec_wt,<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">ylab=</span><span class="st">'y'</span>)
<span class="kw">lines</span>(<span class="dt">x =</span> t,<span class="dt">y =</span> y,<span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">lines</span>(<span class="dt">x =</span> t,<span class="dt">y =</span> rec_wt_1y,<span class="dt">col=</span><span class="st">'green'</span>)
<span class="kw">legend</span>(<span class="st">'topright'</span>, 
       <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;original&quot;</span>, <span class="st">&quot;reconstructed&quot;</span>,<span class="st">&quot;1 year&quot;</span>),
       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>,<span class="st">&quot;green&quot;</span>),
       <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="reconstruct-3-periodicities" class="section level2">
<h2>Reconstruct 3 periodicities</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rec_wt_6m &lt;-
<span class="st">  </span><span class="kw">wt_inverse</span>(<span class="dt">mat_wt =</span> <span class="kw">wt_extract</span>(<span class="dt">mat_wt =</span> mat_wt,
                                 <span class="dt">range_scale =</span> <span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.6</span>)),
             <span class="dt">y.m =</span> <span class="kw">mean</span>(y))

rec_wt_1y &lt;-
<span class="st">  </span><span class="kw">wt_inverse</span>(<span class="dt">mat_wt =</span> <span class="kw">wt_extract</span>(<span class="dt">mat_wt =</span> mat_wt,
                                 <span class="dt">range_scale =</span> <span class="kw">c</span>(<span class="fl">0.8</span>,<span class="fl">1.2</span>)),
             <span class="dt">y.m =</span> <span class="kw">mean</span>(y))

rec_wt_2y &lt;-
<span class="st">  </span><span class="kw">wt_inverse</span>(<span class="dt">mat_wt =</span> <span class="kw">wt_extract</span>(<span class="dt">mat_wt =</span> mat_wt,
                                 <span class="dt">range_scale =</span> <span class="kw">c</span>(<span class="fl">1.7</span>,<span class="fl">2.3</span>)),
             <span class="dt">y.m =</span> <span class="kw">mean</span>(y))

df_all &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(<span class="dt">t=</span>t,<span class="dt">y=</span>y,<span class="dt">periodicity=</span><span class="st">'original'</span>),
        <span class="kw">data.frame</span>(<span class="dt">t=</span>t,<span class="dt">y=</span>rec_wt_6m,<span class="dt">periodicity=</span><span class="st">'6m'</span>),
        <span class="kw">data.frame</span>(<span class="dt">t=</span>t,<span class="dt">y=</span>rec_wt_1y,<span class="dt">periodicity=</span><span class="st">'1y'</span>),
        <span class="kw">data.frame</span>(<span class="dt">t=</span>t,<span class="dt">y=</span>rec_wt_2y,<span class="dt">periodicity=</span><span class="st">'2y'</span>))

<span class="kw">ggplot</span>(<span class="dt">data =</span> df_all,<span class="kw">aes</span>(<span class="dt">x=</span>t,<span class="dt">y=</span>y,<span class="dt">col=</span>periodicity)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The reconstruction captures correctly that the main component in the data is the yearly component, then the biyearly and the biennal.</p>
</div>
</div>
<div id="extract-power-and-phase-time-series" class="section level1">
<h1>Extract power and phase time series</h1>
<p>The final goal of the study is to extract amplitudes and timings for specific periodicities and for different times in the study period.</p>
<div id="extract-time-series-of-power" class="section level2">
<h2>Extract time series of power</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
date_start &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">'2000-01-01'</span>)
date_end &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">'2008-01-01'</span>)

<span class="co"># biyearly decomposition</span>
ts_pow_6m &lt;-
<span class="st">  </span><span class="kw">ts_power</span>(<span class="dt">mat_wt =</span> mat_wt,
           <span class="dt">dates_seq =</span> <span class="kw">seq.Date</span>(<span class="dt">from =</span> date_start,
                                <span class="dt">to =</span> date_end,
                                <span class="dt">by =</span> <span class="st">&quot;6 months&quot;</span>),
           <span class="dt">range_scale =</span> <span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.6</span>))

<span class="co"># yearly decomposition</span>
ts_pow_1y &lt;-
<span class="st">  </span><span class="kw">ts_power</span>(<span class="dt">mat_wt =</span> mat_wt,
           <span class="dt">dates_seq =</span> <span class="kw">seq.Date</span>(<span class="dt">from =</span> date_start,
                                <span class="dt">to =</span> date_end,
                                <span class="dt">by =</span> <span class="st">&quot;1 year&quot;</span>),
           <span class="dt">range_scale =</span> <span class="kw">c</span>(<span class="fl">0.8</span>,<span class="fl">1.2</span>))

<span class="co"># biennial decomposition</span>
ts_pow_2y &lt;-
<span class="st">  </span><span class="kw">ts_power</span>(<span class="dt">mat_wt =</span> mat_wt,
           <span class="dt">dates_seq =</span> <span class="kw">seq.Date</span>(<span class="dt">from =</span> date_start,
                                <span class="dt">to =</span> date_end,
                                <span class="dt">by =</span> <span class="st">&quot;1 year&quot;</span>),
           <span class="dt">range_scale =</span> <span class="kw">c</span>(<span class="fl">1.5</span>,<span class="dv">3</span>))

<span class="co"># plot all in same figure</span>
ts_all &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">rbind</span>(<span class="kw">data.frame</span>(ts_pow_6m,<span class="dt">periodicity=</span><span class="st">&quot;6m&quot;</span>),
        <span class="kw">data.frame</span>(ts_pow_1y,<span class="dt">periodicity=</span><span class="st">&quot;1y&quot;</span>),
        <span class="kw">data.frame</span>(ts_pow_2y,<span class="dt">periodicity=</span><span class="st">&quot;2y&quot;</span>))

<span class="kw">ggplot</span>(<span class="dt">data =</span> ts_all,
       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> date_start,<span class="dt">y=</span>power,<span class="dt">col=</span>periodicity)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;normalized power&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Again, the power analysis correctly spotted that the strongest periodcity is the 1 year periodicity, followed by the 6 months periodity, and followed by the 2 year periodicity.</p>
<p>The problem with averaging the power over a scale band is that the result is highly sensitive to the width of the band. Therefore, I prefer to extract the time series of amplitudes from the reconstructed time series.</p>
</div>
<div id="extract-time-series-of-maximum-amplitude-timings" class="section level2">
<h2>Extract time series of maximum amplitude timings</h2>
<p>Second, extracting phases for a given periodicity consists in applying the <code>calc_phase</code> function on selected coefficients, and calculating the mean for each time point over scales within the specified periodicity range.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">phase_1y &lt;-
<span class="st">  </span><span class="kw">rowMeans</span>(<span class="dt">x =</span> <span class="kw">calc_phase_angle</span>(<span class="kw">wt_extract</span>(<span class="dt">mat_wt =</span> mat_wt,
                                           <span class="dt">range_scale =</span> <span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">1.2</span>),
                                           <span class="dt">fill =</span> <span class="ot">NA</span>)),<span class="dt">na.rm =</span> T)

<span class="kw">plot</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(t),<span class="dt">y =</span> phase_1y,<span class="dt">type=</span><span class="st">'l'</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Then, in order to identify the timing of the maximum amplitude, the function <code>find_zeros_lin</code> can be applied in order to approximate time points when the phase angle is zero. The option <code>bool_dec=F</code> specifies to not look for zeros at times when the function is decreasing (these correspond to minima of in the reconstructed time series).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># extract timings with phases 0</span>
t_max &lt;-<span class="st"> </span><span class="kw">find_zeros_lin</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(t),<span class="dt">f_x =</span> phase_1y,<span class="dt">bool_dec =</span> F)
dates_max &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="kw">approx</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(t),
                            <span class="dt">y =</span> <span class="kw">as.Date</span>(<span class="kw">rownames</span>(mat_wt)),
                            <span class="dt">xout =</span> t_max)<span class="op">$</span>y,
                     <span class="dt">origin =</span> <span class="kw">as.Date</span>(<span class="st">&quot;1970-01-01&quot;</span>))

<span class="kw">plot</span>(<span class="dt">x =</span> <span class="kw">as.Date</span>(<span class="kw">rownames</span>(mat_wt)),<span class="dt">y =</span> phase_1y,
     <span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">xlab=</span><span class="st">'date'</span>,<span class="dt">ylab=</span><span class="st">'phase'</span>)
<span class="kw">points</span>(<span class="dt">x =</span> dates_max,
       <span class="dt">y =</span> <span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(dates_max)),
       <span class="dt">col =</span> <span class="st">'red'</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># check that they correspond to timings of maximum amplitudes</span>
<span class="kw">plot</span>(<span class="dt">x =</span> <span class="kw">as.Date</span>(<span class="kw">rownames</span>(mat_wt)), <span class="dt">y =</span> rec_wt_1y,
     <span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">xlab=</span><span class="st">'date'</span>,<span class="dt">ylab=</span><span class="st">'1 year reconstruction'</span>)
<span class="kw">abline</span>(<span class="dt">v=</span>dates_max,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="extract-time-series-of-amplitudes" class="section level2">
<h2>Extract time series of amplitudes</h2>
<p>Keep it simple : as a first approximation, extract maximum values around maximum timing</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
val_max &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>,<span class="kw">length</span>(dates_max))

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(dates_max)){
  
  <span class="co">#vector of times</span>
  idx_change &lt;-<span class="st"> </span><span class="kw">which</span>( <span class="kw">sign</span>(t <span class="op">-</span><span class="st"> </span>dates_max[i]) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)[<span class="dv">1</span>]
  
  val_max[i] &lt;-<span class="st"> </span><span class="kw">max</span>(rec_wt_1y[idx_change<span class="op">-</span><span class="dv">1</span>],rec_wt_1y[idx_change])
  
}

<span class="kw">plot</span>(<span class="dt">x =</span> <span class="kw">as.Date</span>(<span class="kw">rownames</span>(mat_wt)), <span class="dt">y =</span> rec_wt_1y,
     <span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">xlab=</span><span class="st">'date'</span>,<span class="dt">ylab=</span><span class="st">'1 year reconstruction'</span>)
<span class="kw">points</span>(<span class="dt">x=</span>dates_max,<span class="dt">y=</span>val_max,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAUVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmtv+QOgCQZgCQkGaQ2/+2ZgC225C2///bkDrb////AAD/tmb/25D//7b//9v///863AMBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJoUlEQVR4nO2dAXejKBSF6bSdne50t9lJY9P8/x+6ojE1gtwHPBTt/c7pTEoIwlcEVCDmQoKYtTNQOxQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBvgR9vpqOH39WzE59fAk60IyPm6Dzy68181EtI0G/18xHtdwEfb4+rZmPavlqgxrDKuRhdIoZ9mIeOA4CUBBgJOjjuT3BHt7Wy0uVjBtpOxA6sqm+Z9TN9wPF4+P7apmpEWeg2LAXu4M1CMA2CMBeDMBxEEBZkNkMawnSTU7C6XRK+FSkoPPLL52L1eUFna4/kXybGnQa/RtDvKDz333/lTdQXENQ254sKehYtSCnwfEKEjRLsYIOX8171r37woI8Dc6pFeRKg3UqvQblkS7I81f3VZeLa0gUa0rljbRrw1s3pkHe88lMj2rrFGyWUgQd2svUJu8MEx7XW/RpmD9IJuhSQtChu4w/v2Q9/REdd6boOMjX4LiCLqdWUIE2SOV+kFTQtCLIgrwtlSuoRC82uh+0iiB/ZySpLsKgpIzeR+zvBH08L9DN+4ou6cVyBE0SS2mkNe4HJfdiXcMqCUoUNO0XKu/mk8vpBhn3sMbNiNMvUNB9rFP3e5agRW93rCDIGJ0aFO7lj+1xutHAXF9XWNCMDRzUjR512qBDYKB4bJvwfiS5hCBPRUgXZBR6sZ5AFeqHSp+v7ZA7T9BM0YsK8sWR5vWOwEBxGGy3FyUxgtw+PbmcWUHGiSNhGjF0LTYMttvTMEKQ5zp9k4KGXiz05HnQ0sYVC/LdndmkIBHDg+nP1xhBzoWXYtGN57BlBN3Onyx2LEhnnrSvDXLvzmxSUNyNoMheLKW39hQ9OchNPr2RTrrUCD7yNt7cbk6QDqmCCgep1KBST1ad03/jgoK3XOGaspUEecoOPhgrSPZk9Ti8Oft0aEZQ6epSXpDoyepoqDQ31XMJQb6CioKKN9KjodJcSxUhKP6vvrIgu+TwGLwW061B8YVaWdDh8f3j+Sl8w2yYI6zRBiWXcxxkLpJYOm1Qe/7YNXXBbh5e8usJkhV9YUF24bP6k1VHUHLRZUFx/iGjU+zp/PL4rj55Yf6PV0hQXPKQcSNtHt5yl/YmCiocpCNIhToFBYIgFAT4iqiyd8ecoDpsZDbSGivpdixIZ++OXQsqc096N4J09u7YsSCdvTt2LKjU/KDdCNLBSW6pchpJ0MYEyUqQbEMYhBhFLDLLtchffR1BKuvm9QWVDkLcIursvGCmR08V5CvKuoI012oEbciKXp+grBo0eTZfRpCwwJtog/LrhqagYCxEmV6srnZYS5AGFCRLri4bWoIU16zWZSPYZyC+IqquWZ3+vwNBumtWRYIKa/QknyNId83q9FSLLoGmDaVTTHXNqisosgSFg5Iaac2r+V0K0mCSAQqaTW6Pgs4v5vH9oLR3xw4FNQ9vRzv9RWdjAePkYuuCbDd/DCy2jExuVlAdlSpBkB0oWkHBgWLEqmczzUWUoNIaM2rQIXDDLGbVcz2C0IkeZtoGhW6YRa16dgRFtdueWMnOtAT1z1ZDA8WoVc87FASJWvUcIUgzqJwgyZrVmFXPxsnEIoJAUIYg0fygmFXPzu4/Gxeks5n9jgWpT39xFrC6ggo7mz9ioUZ6RMrmJsaNUNbZmoJSkksVlOzMl5Y3XogFBXVvygTpaPSltZIg2Vbx30BQyqrn+zeTBSU70xIkGiimrHq+f1NW9IKCvA1TgFE3DweKaWtW79/criDBQDFt1fP9m5qCUk5XUUa9EQUDxdpqUEqQKKNJES1Jq57v39y3oKRVz3dv+rqUrQgaCl9uq9JVBM3kKEGQvU/4dPl4junMIo/rv8DfiCD7QKyxd5vhLFdFQb4iKLZUnjory6gvou3DP/760/2EKS9Iq56pCrLFtlvkFBXkXKuJBCVXKlVB3S2ew6/Cp5gnxGMDB60hyO77Mn83Pj45afwkQbLGy3NOjyNLc6gJBWknJ/oyhGRnl9kbVCmCVOcHyT/gCvI15WlBqoJ05wfJP+CpQYJYUkHzxxVy180rzg8Sf0D0hZ6plSqQYnRE0fwgveNmJyv7JpeYFEFEyfwgxeNms7ggwfwgzeNms7wgPD9I87jZeBqviC8o3s44aC0oCJDSixmF/XF2LKif45u7C9WuBV0UHJnNkCaoV5Q91Ux29FpjBT7TGDuRvpsInUWtRc8TZIdBvZns2Yq1Fj1L0Pklc4wYnZFaY+V/RinRWmPlf0Yp0Vpj5X9GKdFaY+V/RinRWmPlf0Yp0Vpj5X/mW0FBgF7Qbf6dxoXGvrjWoNn1Td+e4RTT2S15h9zaIJXdkncIG2kABQEoCEBBAAoCUBCAggAagrp1iN3TomZ4uO++UEjrcombexJK67bRD0JB0Odre8yjfS7btC/sj+eFQloXW74IQaG07EY/sqGxgqB+ecfxx59+AvXh6eK+UEjrcp1FqZOvJ2m+1Nqg9g9zy5H7QiEt++/jP9GP7LxprSHo0B7/pz0RGt8LhbTaKvHzLX7+mz+tRU+xDrsGsW8p2n/dFwppdSdItKCZtOSdh5KgZmgLFQTNpJU0g3IuLfttc7Jta3UE9WtYdU6xYFqRgmbTkreNKoKuGw6oNNKzaR2vt4QjblvNphVRszUEfe1Lld3NB9LqiKpB82n1pkQ1W2UcNJzL+QPFUFqWGEGhtBZtg651vxugjkbykxcKaV3iBAXTOhjhXDperAIoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgHoF3c15aFZbq7UNQaJvhysDBQHqFGRnqfzbzePpppTZL3q3m4RKp6xoUqUgO72psRN57MSy/ttvf/cvZJOeNKlRUD9B7vDwZreQ736zgvpteFW+iTGGGgX1Eprb8pNeUP+74GstdKlR0PEmqG11fvx3rUFN/CxXDWoUdKtBXXUZTrHY+fpK1CjoOp354a0z1ZihDVqlq69R0HWpSV+Dzi9t19410Meu31+6HlUp6DYO6mbtWieHYRy0+BYjdQqqCAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCPA/6NKjz9OGVBUAAAAASUVORK5CYII=" /><!-- --></p>
<p>The amplitude can then be calculated by substracting the mean of <code>y</code> to <code>val_max</code> (in this example the mean is zero).</p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>This vignette shows how to use some code to extract time series of timing and amplitudes corresponding to specific periodicities of interest based on wavelet decomposition.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
